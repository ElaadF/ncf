bundle agent bla_rudder_reporting
{
  vars:
    "args"               slist => {  };
    "report_param"      string => join("_", args);
    "full_class_prefix" string => canonify("bla_rudder_reporting_${report_param}");
    "class_prefix"      string => string_head("${full_class_prefix}", "1000");

  methods:

    !(cfengine)::
      "dummy_report" usebundle => _classes_noop("${class_prefix}_service_start_${bla.apache_package_name}");
      "dummy_report_1" usebundle => _method_reporting_context("ph2", "${bla.apache_package_name}");
      "dummy_report" usebundle => log_rudder("Service start ${bla.apache_package_name} if cfengine", "${bla.apache_package_name}", "${class_prefix}_service_start_${bla.apache_package_name}", "${class_prefix}_service_start_${bla.apache_package_name}", @{args});

    !(cfengine)::
      "dummy_report" usebundle => _classes_noop("${class_prefix}_package_install_openssh_server");
      "dummy_report_2" usebundle => _method_reporting_context("ph3", "openssh-server");
      "dummy_report" usebundle => log_rudder("Package install openssh-server if cfengine", "openssh-server", "${class_prefix}_package_install_openssh_server", "${class_prefix}_package_install_openssh_server", @{args});

    !(cfengine)::
      "dummy_report" usebundle => _classes_noop("${class_prefix}_command_execution__bin_echo__test_");
      "dummy_report_3" usebundle => _method_reporting_context("ph4", "/bin/echo \"test\"");
      "dummy_report" usebundle => log_rudder("Command execution /bin/echo \"test\" if cfengine", "/bin/echo \"test\"", "${class_prefix}_command_execution__bin_echo__test_", "${class_prefix}_command_execution__bin_echo__test_", @{args});
}
